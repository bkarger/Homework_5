---
title: "Homework 5"
output:
  html_document:
    df_print: paged
  pdf_document: default
---
Loading of necessary libraries.
```{r, message=FALSE, warning=FALSE, error=FALSE}
library(tidyverse)
library(rmarkdown)
library(lubridate)
library(tigris)
library(sf)
library(tidyverse)
library(forcats)
options(tigris_class = "sf")
options(tigris_use_cache = TRUE)
```
Loading and cleaning of data. 
```{r, message=FALSE, warning=FALSE, error=FALSE}
homicides <- read_csv("../data/homicide_data.csv") %>% 
  unite(col = "city_state", city, state, sep = ",") %>% 
  mutate(reported_date = ymd(reported_date),
         victim_first = str_to_sentence(victim_first),
         victim_last = str_to_sentence(victim_last),
         solved = disposition == "Closed by arrest") %>% 
  filter(city_state == "Chicago,IL") %>%
  print()
```
Creation of map of Chicago,IL.  
Concersion of df to sf object of homicides.
Thanks Kyle! https://walkerke.github.io/2017/05/tigris-metros/  
```{r, message=FALSE, warning=FALSE, error=FALSE}
sf_homicides <- st_as_sf(x = homicides, coords = c("lon", "lat")) %>% 
  st_set_crs(4269) 

chicago <- tracts("IL", county = "Cook", cb = TRUE)

ggplot() +
  geom_sf(data = chicago) +
  geom_sf(data = sf_homicides, alpha = 0.4) +
  facet_wrap("solved") +
  theme_dark() +
  ggtitle("Chicago Homicide incidents", subtitle = "Faceted by solved (TRUE or FALSE)")
```

